# This is a basic workflow to help you get started with Actions

name: workspace deployment
on:
    push:
        branches: [ publish_branch ]
    workflow_dispatch:
      inputs:
        resourceGroupName:
          description: 'Synapse resource group name'
          required: true
        SynapseWorkspaceName:
          description: 'Synapse Workspace name'
          required: true
        armTemplateFile:
          description: 'ARM template file name'
          required: false
          default: 'TemplateForWorkspace.json'
        armTemplateParametersFile:
          description: 'ARM template parameters file name'
          required: false
          default: 'TemplateParametersForWorkspace.json'
        additionalParameters:
          description: 'Parameters which will be replaced in the ARM template'
          required: false
          default: ''
        skipAzModuleInstallation:
          description: 'Parameters which skip the Az module installation'
          required: false
          default: 'false'
jobs:
  release:
        # You also can use the self-hosted runners.
    runs-on: windows-latest
    steps:
        # Checks out your repository under $GITHUB_WORKSPACE, so your job can access it.
    - uses: actions/checkout@v2
    - uses: azure/synapse-workspace-deployment@release-1.0
      with:
          TargetWorkspaceName: 'target workspace name'
          TemplateFile: './path of the TemplateForWorkspace.json'
          ParametersFile: './path of the TemplateParametersForWorkspace.json'
          OverrideArmParameters: './path of the parameters.yaml'
          environment: 'Azure Public'
          resourceGroup: 'target workspace resource group'
          clientId: ${{secrets.CLIENTID}}
          clientSecret:  ${{secrets.CLIENTSECRET}}
          subscriptionId: 'subscriptionId of the target workspace'
          tenantId: 'tenantId'
          DeleteArtifactsNotInTemplate: 'true'
          managedIdentity: 'False'


    
    
